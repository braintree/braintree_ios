sudo: true
language: objective-c
cache:
  - bundler
  - cocoapods
osx_image: xcode8.1

before_install:
  - brew update || brew update
  - brew outdated xctool || brew upgrade xctool
  - SIMULATOR_ID=$(xcrun instruments -s | grep -o "iPhone 6 (9.3) \[.*\]" | grep -o "\[.*\]" | sed "s/^\[\(.*\)\]$/\1/")

install:
  - bundle install
  - bundle exec pod repo update --silent
  - bundle exec pod install || { rm -rf ./Pods; bundle exec pod install; }

script:
  - echo $SIMULATOR_ID

  - open -a "Simulator" --args -CurrentDeviceUDID $SIMULATOR_ID
  - bundle exec rake spec:unit
  - bundle exec rake spec:api:integration

notifications:
  email:
  #  - team-ios@getbraintree.com
